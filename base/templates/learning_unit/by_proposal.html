{% load staticfiles %}
{% load i18n %}
{% load bootstrap3 %}
{% load entity %}
{% comment "License" %}
    * OSIS stands for Open Student Information System. It's an application
    * designed to manage the core business of higher education institutions,
    * such as universities, faculties, institutes and professional schools.
    * The core business involves the administration of students, teachers,
    * courses, programs and so on.
    *
    * Copyright (C) 2015-2018 Universit√© catholique de Louvain (http://www.uclouvain.be)
    *
    * This program is free software: you can redistribute it and/or modify
    * it under the terms of the GNU General Public License as published by
    * the Free Software Foundation, either version 3 of the License, or
    * (at your option) any later version.
    *
    * This program is distributed in the hope that it will be useful,
    * but WITHOUT ANY WARRANTY; without even the implied warranty of
    * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    * GNU General Public License for more details.
    *
    * A copy of this license - GNU General Public License - is available
    * at the root of the source code of this program.  If not,
    * see http://www.gnu.org/licenses/.
{% endcomment %}

{% block content %}
<div class="panel panel-default">

    {% include "learning_unit/components/search_form_proposal.html" %}

    <div style="margin-top:10px;">
        {% if proposals %}
            <table id="table_learning_units" class="table table-striped table-hover">
                <thead>
                <tr>
                    <th>{% trans 'folder'%}</th>
                    <th>{% trans 'acronym'%}</th>
                    <th>{% trans 'validite'%}</th>
                    <th>{% trans 'title'%}</th>
                    <th>{% trans 'type'%}</th>
                    <th>{% trans 'requirement_entity_small'%}</th>
                    <th>{% trans 'proposal_type' %}</th>
                    <th>{% trans 'proposal_status' %}</th>
                </tr>
                </thead>
                <tbody>
                {% for proposal in proposals %}
                    <tr data-id="{{proposal.id}}" data-value="{{proposal.acronym}}">
                        <td>{{ proposal.folder.entity|entity_last_version }}{{ proposal.folder.folder_id }}</td>
                        <td>{{ proposal.learning_unit_year.acronym }}</td>
                        <td>{{ proposal.learning_unit_year.academic_year }}</td>
                        <td>{{ proposal.learning_unit_year.complete_title |default_if_none:'' }}</td>
                        <td>{% if proposal.learning_unit_year.learning_container_year.container_type %}{% trans proposal.learning_unit_year.learning_container_year.container_type %}{% endif %}</td>
                        <td>{{ learning_units|requirement_entity:forloop.counter0 }}</td>
                        <td>{% if proposal.type %}{%  trans proposal.type  %}{% endif %}</td>
                        <td>{% if proposal.state %}{% trans proposal.state %}{% endif %}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>

        {% endif %}
        </div>
    </div>
{% endblock %}

{% block script %}
    <script>
        $(document).ready(function()
        {
            // Must be always DataTable declaration !!!
            setEventKeepIds('table_learning_units', 'learningUnitIds')

            $('#table_proposals').DataTable(
                    {
                        columnDefs: [
                            { targets: 3, type: 'diacritics-neutralise'}
                        ],
                        "stateSave": true,
                        "paging" : false,
                        "ordering" : true,
                        "info"  : false,
                        "searching" : false,
                        "language": {
                            "oAria": {
                                "sSortAscending":  "{% trans 'datatable_sortascending'%}",
                                "sSortDescending": "{% trans 'datatable_sortdescending'%}",
                            }
                        }
                    });
            });


    </script>
{% endblock %}
