{% extends "layout.html" %}
{% load staticfiles %}
{% load i18n %}

{% comment "License" %}
 * OSIS stands for Open Student Information System. It's an application
 * designed to manage the core business of higher education institutions,
 * such as universities, faculties, institutes and professional schools.
 * The core business involves the administration of students, teachers,
 * courses, programs and so on.
 *
 * Copyright (C) 2015-2016 Universit√© catholique de Louvain (http://www.uclouvain.be)
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * A copy of this license - GNU General Public License - is available
 * at the root of the source code of this program.  If not,
 * see http://www.gnu.org/licenses/.
{% endcomment %}

{% block breadcrumb %}
<li><a href="{% url 'catalog' %}" id="lnk_catalog">{% trans 'catalogue' %}</a></li>
<li><a href="{% url 'learning_units' %}" id="lnk_learning_units">{% trans 'learning_units' %}</a></li>
<li class="active">{% trans 'text_label' %}</li>
{% endblock %}

{% block content %}
<div class="page-header">
    <h2>{{ learning_unit_year.acronym }} - {{ learning_unit_year.title }}</h2>
</div>
<div class="panel panel-default">
  <tr class="panel-body">
      <br>
      <div class="row">
          <form method="post" action="{% url 'translated_text_label_read_from_entity' 1 %}">
          {% csrf_token %}
          <div class="col-md-6"></div>
          <div class="col-md-4">
              <label for="slt_ui_language">{% trans 'language' %}</label>
              <select class="form-control" id="slt_ui_language"  name="ui_language"
                        onchange="">
                    {% for lang in supported_languages %}
                        <option value="{{ lang.code }}" {% if language_selected == lang.code %}selected{% endif %}>{{ lang.name }}</option>
                    {% endfor %}
              </select>
          </div>
          <div class="col-md-2">
              {% if request.user.is_superuser %}
              <br>
              <button type="submit" class="btn btn-primary" title="{% trans 'save'%}" id="lnk_text_label_valid_1">
                    <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
              </button>
              {% endif %}
          </div>
          </form>
      </div>
      <br>
     <table class="table table-striped table-hover" id="tabletxtlabel">
      <thead>
        <th>{% trans 'Rubrique'%}</th>
        <th style="width:50%">{% trans 'Translated'%}</th>
      </thead>
      <tbody>
      {% for text_label in text_labels %}
      {% with counterext=forloop.counter %}
      <tr id="displaylabel_{{forloop.counter}}">
          <td style="width='50%'">
                {% if text_label.part_of %}
                &nbsp;&nbsp;&nbsp;&nbsp;
                {% endif %}
                {{ text_label.label }}
          </td>
          <td style="width='40%'">
              {% for translated_text_label_detail in translated_text_label_details %}
                {% if translated_text_label_detail.text_label.id == text_label.id %}
                    {{ translated_text_label_detail.label }}
                {% endif %}
              {% endfor %}
          </td>
          <td style="width='10%'">
              {% for translated_text_label_detail in translated_text_label_details %}
                    {% if translated_text_label_detail.text_label.id == text_label.id %}
                    <a onclick="edit_row({{counterext}});" id="lnk_text_label_edit_1"
                       class="btn btn-default pull-right" role="button">
                       <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                    </a>
                    {% endif %}
              {% endfor %}
                  <a onclick="add_row({{counterext}});" id="lnk_text_label_add_1"
                       class="btn btn-default pull-right" role="button">
                       <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                  </a>
           </td>
      </tr>

      <tr id="editlabel_{{forloop.counter}}" style="display:none">
          <td>
                {% if text_label.part_of %}
                &nbsp;&nbsp;&nbsp;&nbsp;
                {% endif %}
                {{ text_label.label }}
          </td>
           <!-- Edit existing -->
           {% for translated_text_label_detail in translated_text_label_details %}
                {% if translated_text_label_detail.text_label.id == text_label.id %}
                   <form method="post" action="{% url 'translated_text_lbl_save' 1 text_label.id 'UK' translated_text_label_detail.id %}">
                    {% csrf_token %}
                    <td>
                        <input type="hidden" name="selectedLanguage" value="English">
                        <input class="form-control" value="{{ translated_text_label_detail.label | default_if_none:'' }}"
                               name="label" id="txt_label"/><font class="error">{{ form.label.errors }}</font>
                    </td>

                    <td>
                        <a onclick="show_row({{counterext}});" id="lnk_text_label_delete_1"
                           class="btn btn-danger pull-right" role="button" style="margin-left: 5px;">
                            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                        </a>
                        <button type="submit" class="btn btn-primary pull-right" title="{% trans 'save'%}" id="lnk_text_label_valid_1">
                            <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                        </button>
                    </td>
                    </form>
                {% endif %}
            {% endfor %}
       </tr>

      <tr id="newlabel_{{forloop.counter}}" style="display:none">
          <td>
                {% if text_label.part_of %}
                &nbsp;&nbsp;&nbsp;&nbsp;
                {% endif %}
                {{ text_label.label }}
          </td>
                   <form method="post" action="{% url 'translated_text_lbl_save_new' 1 text_label.id 'UK' %}">
                    {% csrf_token %}
                    <td>
                        <input class="form-control" name="label" id="txt_label"/>
                        <font class="error">{{ form.label.errors }}</font>
                    </td>

                    <td>
                        <a onclick="show_row({{counterext}});" id="lnk_text_label_new_delete_1"
                           class="btn btn-danger pull-right" role="button" style="margin-left: 5px;">
                            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                        </a>
                        <button type="submit" class="btn btn-primary pull-right" title="{% trans 'save'%}" id="lnk_text_label_valid_1">
                            <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                        </button>
                    </td>
                    </form>
       </tr>
      {% endwith %}
      {% endfor %}

      </tbody>
      </table>
      <br>
      <br>
      <br>
   </div>

</div>

<script>

    function add_row(id) {
        $( "#displaylabel_"+id ).hide();
        $( "#editlabel_"+id ).hide();
        $( "#newlabel_"+id ).show();
    }

    function edit_row(id) {
        $( "#displaylabel_"+id ).hide();
        $( "#editlabel_"+id ).show();
        $( "#newlabel_"+id ).hide();
    }

    function show_row(id) {
        $( "#displaylabel_"+id ).show();
        $( "#editlabel_"+id ).hide();
        $( "#newlabel_"+id ).hide();
    }

</script>
{% endblock %}